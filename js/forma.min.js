(()=>{var o=Object.defineProperty;var u=(r,e,t)=>e in r?o(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var a=(r,e,t)=>(u(r,typeof e!="symbol"?e+"":e,t),t);customElements.define("forma-form",class extends HTMLElement{constructor(){super();a(this,"submitHandler",e=>{e.preventDefault(),!this.isSubmitting()&&(this.state="submit",this.disableForm(),this.submitForm(this.form).then(t=>{var s,i;switch(t.status){case"success":this.state="success",this.showSuccessMessage((s=t.data)==null?void 0:s.message),this.reset();break;case"fail":this.state="fail",this.showFailMessage((i=t.data)==null?void 0:i.message);break;case"error":throw this.state="error",Error("Forma: JSend: "+t.message);break}}).catch(t=>{throw this.state="error",this.showErrorMessage(),t}).finally(()=>{this.enableForm()}))});if(this.form=this.querySelector("form"),!this.form)throw Error("Forma: <form> element not found.");this.successMessage=this.querySelector("forma-success"),this.failMessage=this.querySelector("forma-fail"),this.errorMessage=this.querySelector("forma-error"),this.state="initial"}get state(){return this.getAttribute("state")||"initial"}set state(e){if(!["initial","submit","success","fail","error"].includes(e))throw Error("Forma: invalid state: ".value);this.setAttribute("state",e)}connectedCallback(){this.form.addEventListener("submit",this.submitHandler)}disconnectedCallback(){this.form.removeEventListener("submit",this.submitHandler)}isSubmitting(){return this.state==="submit"}disableForm(){this.form.inert=!0}enableForm(){this.form.inert=!1}reset(){this.form.reset()}showMessage(e,t){this.clearMessages();let s=this[`${e}Message`];return!s||(t=t||s.getAttribute("default"),!t)?!1:(s.innerText=t,!0)}showSuccessMessage(e){return this.showMessage("success",e)}showFailMessage(e){return this.showMessage("fail",e)}showErrorMessage(e){return this.showMessage("error",e)}clearMessages(){this.successMessage.innerText="",this.failMessage.innerText="",this.errorMessage.innerText=""}submitForm(e){let t=e.getAttribute("action"),s=e.getAttribute("method")||"post",i=new FormData(e);return fetch(t,{method:s,body:i}).then(n=>n.json()).then(h)}});function h(r){let e=r.status;if(e===void 0)throw Error("Forma: JSend: status field is not present");if(!e)throw Error("Forma: JSend: status field is empty");if(!["success","fail","error"].includes(e))throw Error("Forma: JSend: invalid status: "+e);if((e==="success"||e==="fail")&&r.data===void 0)throw Error("Forma: JSend: data field is not present");if(e==="error"&&r.message===void 0)throw Error("Forma: JSend: message field is not present");return r}document.addEventListener("submit",r=>{let e=r.target;if(!e.hasAttribute("data-secret"))return;let t=e.getAttribute("data-secret"),s=e._secret;s||(s=document.createElement("input"),s.name="_secret",s.type="hidden",e.append(s)),s.value=t},{capture:!0});})();
